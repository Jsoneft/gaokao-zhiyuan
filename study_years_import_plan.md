# 学制数据导入执行计划

## 数据分析结果总结

### ✅ 数据质量评估
- **ID完全匹配**: 新文件和原文件的ID 100%一致 (543,686个ID)
- **学制数据覆盖率**: 74.35% (404,225个ID有学制信息)
- **数据一致性**: 无ID对应多个不同学制值的情况
- **数据完整性**: 434,614条记录包含学制信息

### 📊 学制值分布
1. **数字格式** (主要):
   - `4`: 328,806条 (299,868个唯一ID) - 四年制
   - `3`: 22,841条 (22,841个唯一ID) - 三年制  
   - `5`: 14,588条 (13,615个唯一ID) - 五年制
   - `1`: 2,009条 (1,574个唯一ID) - 一年制

2. **中文格式**:
   - `四年`: 62,555条 (62,555个唯一ID)
   - `五年`: 3,081条 (3,081个唯一ID)
   - `一年`: 103条 (103个唯一ID)

3. **医学专业**:
   - `八年医`: 73条 (73个唯一ID)
   - `七年医`: 12条 (12个唯一ID)
   - `九年医`: 18条 (18个唯一ID)

4. **特殊情况**:
   - `四年/五年`: 22条 (弹性学制)
   - `国内三年国外一年`: 6条 (国际合作项目)

## 🔄 执行步骤

### 第一步: 数据库表结构变更
```sql
-- 1. 为admission_data表添加study_years字段
ALTER TABLE gaokao.admission_data 
ADD COLUMN study_years Nullable(String) DEFAULT NULL;

-- 2. 验证表结构
DESCRIBE gaokao.admission_data;
```

### 第二步: 数据导入
- 提取有学制信息的记录
- 创建UPDATE语句更新对应ID的study_years字段
- 分批执行以避免性能问题

### 第三步: 后端代码适配
1. **更新models/models.go**:
   ```go
   type AdmissionData struct {
       // ... 现有字段 ...
       StudyYears *string `json:"study_years" db:"study_years"`
   }
   ```

2. **更新handlers/handlers.go**:
   - 在查询结果中包含study_years字段
   - 在API响应中返回学制信息

### 第四步: 验证和测试
- 验证数据导入是否成功
- 测试API接口是否正确返回学制信息
- 检查数据一致性

## ⚠️ 风险评估

### 低风险
- **数据一致性**: ID完全匹配，无冲突
- **类型安全**: 使用Nullable(String)类型，兼容性好
- **回滚能力**: 可以轻松删除新增字段

### 注意事项
- **25.65%的记录**: 无学制信息，将保持NULL值
- **数据格式**: 混合了数字和中文格式，需要在应用层统一处理
- **特殊值**: 如"四年/五年"等需要前端正确显示

## 📋 执行前确认清单

请确认以下事项后再执行：

- [ ] **备份确认**: 是否需要先备份ClickHouse数据？
- [ ] **停机时间**: 是否需要停止服务进行维护？
- [ ] **字段类型**: 确认使用Nullable(String)类型
- [ ] **数据格式**: 是否需要统一学制格式？
- [ ] **API变更**: 前端是否准备好接收新字段？
- [ ] **测试环境**: 是否先在测试环境验证？

## 🚀 预期效果

执行完成后：
1. **数据完整性提升**: 74.35%的记录将包含学制信息
2. **查询功能增强**: 用户可以按学制筛选专业
3. **用户体验改善**: 提供更详细的专业信息
4. **数据价值提升**: 学制信息有助于志愿填报决策

---

**请确认是否同意执行此计划？** 